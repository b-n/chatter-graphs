<!DOCTYPE html>
<html>
    <head>
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="chart.js"></script>
        <style>
            .p-line {
                fill: none;
                stroke: black;
                stroke-width: 1.5px;
            }
        </style>

    </head>
    <body>
        <script>

        const init = () => {
            const chart = new ChatterGraph(1000,800);
            chart.buildChart();
            //buildChart();

            getChatterPosts()
                .then(data => chart.updateData(data));
        };

        const getChatterPosts = () => {
//            return new Promise((resolve, reject) => { resolve(JSON.parse('[{"chatterActivity":{"commentCount":0,"commentReceivedCount":0,"likeReceivedCount":0,"postCount":0},"chatterInfluence":{"percentile":"0.0","rank":330},"name":"Aarno Korpela","email":"aarno.korpela@fronde.com","username":"aarno.korpela@fronde.com","followersCount":0,"groupCount":6,"managerName":"xWendell Holmes","title":"Senior Linux Engineer"},{"chatterActivity":{"commentCount":0,"commentReceivedCount":0,"likeReceivedCount":0,"postCount":0},"chatterInfluence":{"percentile":"0.0","rank":330},"name":"Adeleh Haghani","email":"adeleh.hanghani@fronde.com","username":"adeleh.haghani@fronde.com","followersCount":0,"groupCount":0,"managerName":"Paul Forgan","title":"Developer Java Level 2"},{"chatterActivity":{"commentCount":29,"commentReceivedCount":4,"likeReceivedCount":43,"postCount":11},"chatterInfluence":{"percentile":"0.6796875","rank":82},"name":"Adnan Belushi","email":"adnan.belushi@fronde.com","username":"adnan.belushi@fronde.com","followersCount":0,"groupCount":7,"managerName":"Dean Evitt","title":"Project Manager Level 2"},{"chatterActivity":{"commentCount":19,"commentReceivedCount":16,"likeReceivedCount":7,"postCount":5},"chatterInfluence":{"percentile":"0.640625","rank":92},"name":"Akil Narayana","email":"akil.narayana@fronde.com","username":"akil.narayana@fronde.com","followersCount":0,"groupCount":11,"managerName":"Dean Evitt","title":"Business Analyst"},{"chatterActivity":{"commentCount":1,"commentReceivedCount":2,"likeReceivedCount":11,"postCount":3},"chatterInfluence":{"percentile":"0.46875","rank":136},"name":"Allan Mills","email":"allan.mills@fronde.com","username":"allan.mills@fronde.com","followersCount":1,"groupCount":6,"managerName":"Mike Roxburgh","title":"Business Development Manager"},{"chatterActivity":{"commentCount":0,"commentReceivedCount":0,"likeReceivedCount":0,"postCount":0},"chatterInfluence":{"percentile":"0.0","rank":330},"name":"Amanda Joe","email":"amanda.joe@fronde.com","username":"amanda.joe@fronde.com","followersCount":0,"groupCount":2,"managerName":"Frank Fumic","title":null},{"chatterActivity":{"commentCount":0,"commentReceivedCount":2,"likeReceivedCount":14,"postCount":11},"chatterInfluence":{"percentile":"0.5078125","rank":126},"name":"Amelia Ford","email":"amelia.ford@fronde.com","username":"amelia.ford@fronde.com","followersCount":3,"groupCount":0,"managerName":"Chris Hatton","title":"Client Executive"},{"chatterActivity":{"commentCount":7,"commentReceivedCount":0,"likeReceivedCount":8,"postCount":2},"chatterInfluence":{"percentile":"0.359375","rank":164},"name":"Amit Janghu","email":"amit.janghu@fronde.com","username":"amit.janghu@fronde.com","followersCount":1,"groupCount":5,"managerName":"xGrant Smithson","title":"Test Analyst Level 2"}]')); });
            return fetch('/data').then(result => result.json());
        }

        document.addEventListener('DOMContentLoaded', () => { init() });
        </script>
    </body>
</html>
